# Ship Selection Rework

Новый интерфейс выбора кораблей с группировкой по фракциям и современным дизайном.

## Что делает

Заменяет стандартный выбор кораблей на двухэтапный процесс:
1. Сначала выбираешь фракцию (8 основных групп)
2. Потом смотришь корабли этой фракции с фильтрами и сортировкой

## Новый дизайн интерфейса

### Шапка корабля
- **Название корабля** - жирный текст в сером полупрозрачном блоке (обрезается до 15 символов с тултипом)
- **Бейджи информации** - компактные чипы с метаданными:
  - Класс корабля (серый)
  - Фракция (цветной согласно схеме)
  - Экипаж (серый с зеленой цифрой и иконкой 👥)
- **Мемо Капитана** - тултип с текстом мемо при наведении
- **Кнопка "Вступить в команду"** - зеленая акцентная кнопка

### Адаптивность
- При узкой ширине мемо и кнопка переносятся под бейджи
- Все элементы остаются в логичном порядке
- Правильные отступы между элементами

## Фракции

- **Nanotrasen** - корпоративные корабли (синий с белым)
- **Syndicate** - синдикатские корабли (темно-красный с белым)
- **InteQ** - корабли InteQ Risk Management (коричневый #774b27 с золотым)
- **SolFed** - федеральные корабли (синий с золотым)
- **Independent** - независимые корабли (коричневый с золотым)
- **Elysium** - элизиумские корабли (зеленый с белым)
- **Pirates** - пиратские корабли (черный с белым)
- **Other** - все остальные корабли (темно-синий с белым)

## Логотипы

Нужны PNG файлы 96x64 пикселей в папке `mod_celadon/_storge_icons/icons/assets/logo/`:
- `nanotrasen.png`
- `syndicate.png` 
- `inteq.png`
- `solfed.png`
- `independent.png`
- `elysium.png`
- `pirates.png`
- `other.png`

## Как работает

Модуль перехватывает стандартный интерфейс выбора кораблей и показывает сначала выбор фракции, потом список кораблей с возможностью фильтрации по тегам и сортировки.

### Система отношений между фракциями
- **Семиугольная схема** с центральной фракцией "Other"
- **Цветовые линии** показывают отношения: союз (зеленый), положительные (светло-синий), нейтральные (серый), отрицательные (оранжевый), война (красный)
- **21 линия отношений** между всеми фракциями
- **Интерактивность**: при наведении на фракцию подсвечиваются все её линии отношений
- **Визуальные эффекты**: подсвеченные линии становятся толще (5px), ярче и получают свечение
- **Плавные переходы**: анимация 0.2s для всех изменений

### Ограничение текста
- Названия кораблей обрезаются до 15 символов с добавлением "..."
- При наведении показывается полное название в тултипе
- Функция `truncateText()` обеспечивает корректную обрезку

## Файлы

### TGUI интерфейсы
- `ShipFactionSelect.js` - экран выбора фракции с семиугольной схемой
- `ShipBrowser.js` - список кораблей с фильтрами и темами фракций
- `ShipSelect.js` - основной интерфейс с новой шапкой и бейджами
- `FactionButtons.js` - компонент кнопок фракций с отношениями

### DM файлы
- `ship_select.dm` - логика переключения между экранами (override в `_master_files`)
- `asset_list_items.dm` - определение assets для логотипов фракций

### Модульные файлы
- `_ship_selection_rework.dm` - определения модуля
- `_modpack.dm` - метаданные модуля
- `README.md` - документация

## Технические особенности

### TGUI Assets
- Логотипы загружаются через `resolveAsset()` из `mod_celadon/_storge_icons/icons/assets/logo/`
- Цветовые схемы фракций в `FACTION_COLORS`
- Адаптивная верстка с `Flex` и `wrap`
- Интерактивные эффекты с `useLocalState` для отслеживания наведенных элементов

### DM Backend
- Переопределение `ui_interact()`, `ui_act()`, `ui_data()` в `_master_files`
- Система флагов для корректного переключения между вкладками
- Поддержка всех стандартных функций выбора кораблей
- Добавление assets через `ui_assets()`

### Функции обрезки текста
```javascript
const truncateText = (text, maxLength) => {
  if (!text) return '';
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength) + '...';
};
```

## Изменения в кор коде

### [CELADON-EDIT] теги добавлены в:
- `code/modules/asset_cache/asset_list_items.dm` - добавлен asset `faction_logos`
- `mod_celadon/_master_files/code/modules/mob/dead/new_player/ship_select.dm` - переопределение логики выбора кораблей

## Автор

Турон/Mirag1993

